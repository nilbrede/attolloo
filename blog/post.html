<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="post-title">Blogginnlegg</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    .post-container {
      max-width: 800px;
      margin: 4rem auto;
      padding: 0 1rem;
    }
    .post-container h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    .post-container time {
      color: #666;
      font-size: 0.9rem;
    }
    .post-container img {
      max-width: 100%;
      border-radius: 12px;
      margin: 1rem 0;
    }
    .back-link {
      display: inline-block;
      margin-bottom: 2rem;
      color: #0077cc;
      text-decoration: none;
    }
    .back-link:hover {
      text-decoration: underline;
    }
    .post-body {
      line-height: 1.6;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <a href="/index.html"><img src="/aab-logo.png" alt="Attolloo" style="height:40px"></a>
    </div>
  </header>

  <main class="post-container">
    <a href="/blog/index.html" class="back-link">← Tilbake til bloggen</a>
    <h1 id="post-title-text"></h1>
    <time id="post-date"></time>
    <img id="post-cover" alt="">
    <div id="post-body" class="post-body"></div>
  </main>

  <footer>
    <div class="container">
      <p><span id="year"></span> Attolloogroup. Alle rettigheter forbeholdt.</p>
    </div>
  </footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
  <!-- Markdown parser -->
  <script>
    // Finn slug fra URL (?p=slug)
    const params = new URLSearchParams(window.location.search);
    const slug = params.get("p");

    async function loadPost() {
      try {
        const posts = await fetch("/blog/posts.json").then(r => r.json());
        const post = posts.find(p => p.slug === slug);
        if (!post) throw new Error("Fant ikke innlegget");

        // Sett metadata
        document.title = post.title + " – Attolloo Blogg";
        document.getElementById("post-title-text").textContent = post.title;
        document.getElementById("post-date").textContent = post.date;
        document.getElementById("post-cover").src = post.cover;

        // Hent markdown-innhold
        const md = await fetch(`/blog/posts/${slug}.md`).then(r => r.text());
        document.getElementById("post-body").innerHTML = marked.parse(md);
      } catch (e) {
        document.getElementById("post-body").innerHTML = "<p>Klarte ikke å laste innlegget.</p>";
      }
    }
    loadPost();

    // Sett årstall i footer
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</body>
</html>
