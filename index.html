<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <title>Attolloogroup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- valgfritt: din felles css -->
  <link rel="stylesheet" href="/style.css?v=5" />
  <style>
    /* ====== Layout / header ====== */
    .site-header { background:#fff; }
    .site-brand{
      max-width:1100px; margin:0 auto; padding:.75rem 1rem;
      display:flex; align-items:center; justify-content:space-between;
      gap:1rem;
    }
    .site-logo{display:flex; align-items:center; gap:.5rem; text-decoration:none; color:inherit}
    .site-logo img{height:40px; width:auto}
    .site-brand_text{font-weight:600; font-size:1.1rem; color:#1f2937}

    .main-nav ul{
      display:flex; gap:1rem; list-style:none; margin:0; padding:0;
    }
    .main-nav a{ text-decoration:none; color:inherit }
    .main-nav a:hover{ text-decoration:underline }

    .page-top-space{height:.25rem}

    /* ====== Hero ====== */
    :root{
      --hero-min: 280px;
      --hero-max: 420px;
    }
    .hero{
      position:relative;
      min-height:clamp(var(--hero-min), 25vw, var(--hero-max));
      background:#111;
      color:#fff;
      display:grid; place-items:center;
      isolation:isolate;
      overflow:hidden;
    }
    .hero.has-image::before{
      content:""; position:absolute; inset:0;
      background-size:cover; background-position:center;
      background-image:var(--hero-image, none);
      z-index:-2;
      transform:scale(1.02);
    }
    .hero_overlay{
      position:absolute; inset:0; background:linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.55));
      z-index:-1;
    }
    .hero .inner{
      width:100%; max-width:1100px; padding:1.25rem; text-align:center;
    }
    #heroTitle{ font-size:clamp(1.6rem, 3.5vw, 2rem); margin:.25rem 0 .5rem 0 }
    #heroSubTitle{ margin:0; line-height:1.5; max-width:60ch; margin-inline:auto }

    /* ====== Container ====== */
    .container{ max-width:1100px; margin:0 auto; padding:0 1rem }

    /* ====== Cards (seksjoner) ====== */
    .cards{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(260px,1fr));
      gap:20px; margin:1.25rem 0 2rem 0;
    }
    .card{
      border:1px solid #e5e7eb; border-radius:12px; background:#fff;
      overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,.04);
    }
    .card_media{
      position:relative; height:0; padding-top:56.25%; /* 16:9 */
      background:#f3f4f6; overflow:hidden;
    }
    .card_media img{
      position:absolute; inset:0; width:100%; height:100%; object-fit:cover; display:block;
    }
    .card_body{ padding:1rem }
    .card_title{ margin:.25rem 0 .5rem 0; font-size:1.05rem }
    .card_text{ margin:0; color:#4b5563; line-height:1.6 }

    /* ====== Blogg preview ====== */
    .home-blog{
      margin:2rem 0 3rem 0;
    }
    .att-card{
      border:1px solid #e5e7eb; border-radius:12px; background:#fff;
      box-shadow:0 2px 8px rgba(0,0,0,.04); padding:1rem;
    }
    .att-card_head{
      display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:.5rem;
    }
    .att-card_title{ margin:0; font-size:1.25rem }
    .att-chip{
      display:inline-block; font-size:.9rem; text-decoration:none; padding:.4rem .65rem;
      border:1px solid #e5e7eb; border-radius:999px; color:inherit
    }
    .att-home-blog_grid{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(250px,1fr));
      gap:20px; margin-top:.75rem;
    }
    .att-card_thumb{
      display:block; border-radius:10px; overflow:hidden; border:1px solid #e5e7eb; box-shadow:0 2px 8px rgba(0,0,0,.04);
    }
    .att-card_thumb img{
      width:100%; height:160px; object-fit:cover; display:block;
    }
    .att-card_body{ padding:.5rem .25rem 0 .25rem }
    .att-card_date{ font-size:.9rem; color:#6b7280 }
    .att-card_title a{ color:inherit; text-decoration:none }
    .att-card_title a:hover{ text-decoration:underline }
    .att-card_excerpt{ color:#4b5563; margin:.3rem 0 0 0; line-height:1.5 }

    /* Sikkerhet: aldri tilfeldig img rett etter hero */
    main.container > img { display:none !important; }

    /* ====== Footer ====== */
    footer{ margin:2rem 0 3rem 0 }
    footer .container{ color:#4b5563 }
  </style>
</head>
<body data-page="home">

  <!-- HEADER -->
  <header class="site-header">
    <div class="site-brand">
      <a class="site-logo" href="/index.html" aria-label="Til forsiden">
        <img src="/aab-logo.png" alt="Attolloo logo" />
        <span class="site-brand_text">Attolloo Group</span>
      </a>

      <nav class="main-nav" aria-label="Hovedmeny">
        <ul>
          <li><a href="/index.html" aria-current="page">Forside</a></li>
          <li><a href="/about.html">Om oss</a></li>
          <li><a href="/services.html">Tjenester</a></li>
          <li><a href="/blog/index.html">Blogg</a></li>
        </ul>
      </nav>
    </div>
    <div class="page-top-space"></div>
  </header>

  <!-- HERO (fra CMS) -->
  <section class="hero" id="home-hero" aria-labelledby="heroTitle">
    <div class="hero_overlay"></div>
    <div class="inner">
      <h1 id="heroTitle"> </h1>
      <p id="heroSubTitle"> </p>
    </div>
  </section>

  <!-- INNHOLD -->
  <main class="container">
    <!-- Seksjoner fra CMS -->
    <section class="section">
      <div id="home-cards" class="cards"></div>
    </section>

    <!-- Siste fra bloggen -->
    <section class="home-blog" aria-labelledby="att-home-blog-title">
      <div class="att-card">
        <div class="att-card_head">
          <h2 class="att-card_title" id="att-home-blog-title">Siste fra bloggen</h2>
          <a class="att-chip" href="/blog/index.html" aria-label="Gå til bloggen">Se alle innlegg</a>
        </div>
        <div id="att-home-blog-list" class="att-home-blog_grid" aria-live="polite"></div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <p>©<span id="year"></span> Attolloogroup. Alle rettigheter forbeholdt.</p>
      <p>Org.nr: 936 616 758</p>
      <p>Kontakt: <a href="mailto:post@attolloogroup.com">post@attolloogroup.com</a></p>
    </div>
  </footer>

  <!-- JS: årstall i footer -->
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>

  <!-- JS: Hent hero/innhold fra CMS -->
  <script>
    (async function loadHome(){
      try{
        const res  = await fetch('/data/home.json?'+Date.now(), { cache:'no-store' });
        const data = await res.json();

        /* Hero-tekst */
        document.getElementById('heroTitle').textContent    = data.title || '';
        document.getElementById('heroSubTitle').textContent = data.subtitle || '';

        /* Hero-bilde (bakgrunn) */
        const hero = document.getElementById('home-hero');
        if (data.hero_image){
          hero.style.setProperty('--hero-image', `url(${data.hero_image})`);
          hero.classList.add('has-image');
        }else{
          hero.classList.remove('has-image');
        }

        /* Seksjonskort */
        const wrap = document.getElementById('home-cards');
        const sections = Array.isArray(data.sections) ? data.sections : [];
        const clean = sections.filter(s => (s.heading && s.heading.trim()) || (s.body && s.body.trim()));
        wrap.innerHTML = clean.length ? clean.map(s => `
          <article class="card">
            <div class="card_media">
              ${s.image ? `<img src="${s.image}" alt="">` : ''}
            </div>
            <div class="card_body">
              ${s.heading ? `<h3 class="card_title">${s.heading}</h3>` : ''}
              ${s.body ? `<p class="card_text">${s.body}</p>` : ''}
            </div>
          </article>
        `).join('') : '<p>Ingen innholdseksjoner er lagt til ennå.</p>';
      }catch(e){
        console.error('Kunne ikke laste home.json', e);
      }
    })();
  </script>

  <!-- JS: Hent 3 siste blogginnlegg -->
  <script>
    (async function attLoadHomeBlog(){
      const wrap = document.getElementById('att-home-blog-list');
      if (!wrap) return;
      try{
        const res   = await fetch('/blog/posts.json?'+Date.now(), { cache:'no-store' });
        const posts = await res.json();

        // Sorter nyeste først (ISO-datoer)
        posts.sort((a,b) => (b.date||'').localeCompare(a.date||''));
        const latest = posts.slice(0,3);

        const fmt = d => {
          const dt = new Date(String(d).slice(0,10) + 'T00:00:00');
          return isNaN(dt) ? '' : dt.toLocaleDateString('no-NO');
        };

        wrap.innerHTML = latest.length ? latest.map(p => `
          <article class="att-card">
            <a class="att-card_thumb" href="/blog/post.html?p=${encodeURIComponent(p.slug)}">
              <img src="${p.cover}" alt="" loading="lazy" decoding="async">
            </a>
            <div class="att-card_body">
              <div class="att-card_date">${fmt(p.date)}</div>
              <h3 class="att-card_title">
                <a href="/blog/post.html?p=${encodeURIComponent(p.slug)}">${p.title || 'Uten tittel'}</a>
              </h3>
              ${p.excerpt ? `<p class="att-card_excerpt">${p.excerpt}</p>` : ''}
            </div>
          </article>
        `).join('') : '<p><em>Ingen innlegg publisert ennå.</em></p>';
      }catch(e){
        console.error(e);
        wrap.innerHTML = '<p>Klarte ikke å laste blogginnlegg akkurat nå.</p>';
      }
    })();
  </script>
</body>
</html>
